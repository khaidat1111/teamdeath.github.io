<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Death End</title>
    <style>
        :root {
            --primary-color: #1e90ff;
        }
        body { margin: 0; font-family: 'Courier New', monospace; color: #fff; min-height: 100vh; overflow-x: hidden; position: relative; transition: background 0.5s; }
        canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        body::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(45deg, #ff4500, #8a2be2, #1e90ff, #ffd700); background-size: 400%; opacity: 0.4; animation: gradient 15s ease infinite; z-index: -1; }
        @keyframes gradient { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        body.light { background: #f0f0f0; color: #000; }
        body.light .header, body.light .sidebar, body.light .content-section { background: rgba(255, 255, 255, 0.9); border-color: var(--primary-color); box-shadow: 0 0 10px var(--primary-color); }
        body.light .header h1, body.light .sidebar h2, body.light .content-section h2 { color: var(--primary-color); text-shadow: none; }
        body.light .content-section p, body.light .content-section ul, body.light .content-section li { color: #000; }
        body.light .rank.owner { color: #d4af37; text-shadow: 0 0 5px #d4af37; }
        body.light .rank.admin { color: #ff4500; text-shadow: 0 0 5px #ff4500; }
        body.light .rank.leader { color: #1e90ff; text-shadow: 0 0 5px #1e90ff; }
        body.light .rank.member { color: #32cd32; text-shadow: 0 0 5px #32cd32; }
        body.dark { background: #1a1a1a; }
        body.dark::before { opacity: 0.2; }
        .header { display: flex; align-items: center; justify-content: space-between; padding: 10px 20px; background: linear-gradient(45deg, #2a1a2a, #3a2a3a); box-shadow: 0 0 20px #ff4500, 0 0 40px #8a2be2; position: sticky; top: 0; z-index: 10; }
        .header img { width: 50px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
        .header h1 { margin: 0; font-size: 24px; color: #ffd700; text-shadow: 0 0 10px #ff4500, 0 0 20px #8a2be2; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .header button { padding: 8px 16px; border: 2px solid #ff4500; border-radius: 8px; background: #ff4500; color: #fff; font-size: 14px; cursor: pointer; transition: all 0.3s; }
        .header button:hover { background: #cc3700; box-shadow: 0 0 15px #ff4500; }
        .container { display: flex; min-height: calc(100vh - 70px); flex-direction: row; }
        .sidebar { width: 250px; background: linear-gradient(180deg, #2a1a2a, #1a0a1a); padding: 20px; border-right: 2px solid var(--primary-color); box-shadow: 0 0 20px var(--primary-color), 0 0 40px #8a2be2; position: fixed; top: 70px; bottom: 0; z-index: 5; transition: all 0.3s ease-in-out; }
        .sidebar.top { width: 100%; height: auto; position: sticky; top: 70px; left: 0; border-right: none; border-bottom: 2px solid var(--primary-color); }
        .sidebar.top ul { display: flex; flex-wrap: wrap; justify-content: center; }
        .sidebar.top li { margin: 5px 10px; }
        .sidebar.right { left: auto; right: 0; border-right: none; border-left: 2px solid var(--primary-color); }
        .sidebar h2 { margin: 0 0 20px; color: #ffd700; text-shadow: 0 0 10px #ff4500; font-size: 18px; text-align: center; animation: neon 1.5s infinite alternate; }
        @keyframes neon { from { text-shadow: 0 0 5px var(--primary-color); } to { text-shadow: 0 0 15px #8a2be2, 0 0 30px #ff4500; } }
        .sidebar ul { list-style: none; padding: 0; }
        .sidebar li { margin: 10px 0; }
        .sidebar a { display: block; padding: 10px; color: #fff; text-decoration: none; border: 2px solid transparent; border-radius: 8px; transition: all 0.3s; }
        .sidebar a:hover, .sidebar a.active { border-color: var(--primary-color); color: var(--primary-color); background: rgba(30, 144, 255, 0.1); box-shadow: 0 0 15px var(--primary-color); transform: scale(1.05); }
        .main-content { margin-left: 250px; padding: 20px; flex-grow: 1; }
        .main-content.top { margin-left: 0; margin-top: 150px; }
        .main-content.right { margin-left: 0; margin-right: 250px; }
        .content-section { display: none; background: rgba(42, 26, 42, 0.9); border: 2px solid var(--primary-color); border-radius: 10px; padding: 20px; box-shadow: 0 0 20px var(--primary-color), 0 0 40px #8a2be2; animation: fadeIn 0.5s; }
        .content-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .content-section h2 { margin: 0 0 15px; color: #ffd700; text-shadow: 0 0 10px #ff4500; font-size: 20px; }
        .content-section p, .content-section ul { margin: 5px 0; font-size: 14px; color: #fff; }
        .content-section ul { list-style: none; padding: 0; }
        .content-section li { margin: 10px 0; }
        .content-section a { color: var(--primary-color); text-decoration: underline; }
        .content-section a:hover { color: #00bfff; text-shadow: 0 0 10px #00bfff; }
        .members { display: flex; flex-wrap: wrap; gap: 20px; }
        .member { text-align: center; transition: transform 0.3s; cursor: pointer; position: relative; }
        .member img { width: 80px; height: 80px; border-radius: 10%; border: 2px solid var(--primary-color); transition: all 0.3s; }
        .member img:hover { transform: rotate(10deg) scale(1.1); box-shadow: 0 0 15px var(--primary-color); }
        .member .name-container { display: flex; align-items: center; justify-content: center; gap: 5px; }
        .member .name-icon { width: 20px; height: 20px; border-radius: 50%; border: 1px solid var(--primary-color); }
        .member p { margin: 5px 0; font-size: 12px; }
        .rank { font-size: 10px; text-shadow: 0 0 5px rgba(255, 255, 255, 0.5); }
        .rank.owner { color: #ffd700; text-shadow: 0 0 5px #ffd700; }
        .rank.admin { color: #ff4500; text-shadow: 0 0 5px #ff4500; }
        .rank.leader { color: #1e90ff; text-shadow: 0 0 5px #1e90ff; }
        .rank.member { color: #32cd32; text-shadow: 0 0 5px #32cd32; }
        .member-details { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(42, 26, 42, 0.95); border: 2px solid var(--primary-color); border-radius: 10px; padding: 20px; box-shadow: 0 0 20px var(--primary-color); z-index: 100; width: 300px; }
        .member-details.active { display: block; }
        .member-details img { width: 100px; height: 100px; border-radius: 10%; border: 2px solid var(--primary-color); display: block; margin: 0 auto; }
        .member-details p { margin: 10px 0; font-size: 14px; }
        .member-details .edit-form { display: none; margin-top: 10px; }
        .member-details .edit-form input { padding: 5px; margin: 5px 0; width: 100%; background: rgba(255, 255, 255, 0.1); border: 2px solid var(--primary-color); border-radius: 5px; color: #fff; }
        .member-details .edit-form button, .member-details .edit-btn, .member-details .delete-btn, .member-details .close-btn { background: #ff4500; padding: 5px 10px; border: 2px solid #ff4500; border-radius: 5px; color: #fff; cursor: pointer; transition: all 0.3s; display: block; margin: 5px auto; }
        .member-details .edit-form button:hover, .member-details .edit-btn:hover, .member-details .delete-btn:hover, .member-details .close-btn:hover { background: #cc3700; box-shadow: 0 0 10px #ff4500; }
        .add-btn { display: inline-block; padding: 10px; background: #8a2be2; border: 2px solid #8a2be2; border-radius: 50%; color: #fff; font-size: 20px; cursor: pointer; transition: all 0.3s; margin-top: 10px; }
        .add-btn:hover { background: #6a1abe; box-shadow: 0 0 15px #8a2be2; transform: scale(1.1); }
        .add-form { display: none; margin-top: 15px; padding: 10px; background: rgba(0, 0, 0, 0.5); border-radius: 8px; }
        .add-form input, .add-form button { padding: 8px; margin: 5px 0; width: 100%; background: rgba(255, 255, 255, 0.1); border: 2px solid var(--primary-color); border-radius: 5px; color: #fff; }
        .add-form button { background: var(--primary-color); color: #000; cursor: pointer; transition: all 0.3s; }
        .add-form button:hover { background: #00bfff; box-shadow: 0 0 15px var(--primary-color); }
        .admin-panel { display: none; margin-top: 15px; padding: 10px; background: rgba(138, 43, 226, 0.8); border-radius: 8px; }
        .admin-panel h3 { color: #ffd700; text-shadow: 0 0 10px #ff4500; }
        .admin-panel select, .admin-panel input, .admin-panel button { padding: 8px; margin: 5px 0; width: 100%; border: 2px solid var(--primary-color); border-radius: 5px; background: rgba(255, 255, 255, 0.1); color: #fff; }
        .admin-panel button { background: #ff4500; color: #fff; cursor: pointer; transition: all 0.3s; }
        .admin-panel button:hover { background: #cc3700; box-shadow: 0 0 15px #ff4500; }
        .chat-container { max-height: 400px; overflow-y: auto; border: 1px solid var(--primary-color); padding: 10px; border-radius: 5px; }
        .chat-message { margin: 5px 0; padding: 5px; background: rgba(255, 255, 255, 0.1); border-radius: 5px; }
        .chat-message span { font-weight: bold; }
        .chat-form { margin-top: 10px; }
        .chat-form input { padding: 8px; width: calc(100% - 80px); background: rgba(255, 255, 255, 0.1); border: 2px solid var(--primary-color); border-radius: 5px; color: #fff; }
        .chat-form button { padding: 8px; width: 70px; background: var(--primary-color); border: 2px solid var(--primary-color); border-radius: 5px; color: #000; cursor: pointer; transition: all 0.3s; }
        .chat-form button:hover { background: #00bfff; box-shadow: 0 0 15px var(--primary-color); }
        .theme-options { margin-top: 15px; }
        .theme-options label { margin-right: 10px; font-size: 14px; }
        .theme-options input { vertical-align: middle; }
        .theme-options input[type="color"] { width: 50px; height: 30px; padding: 2px; border: 2px solid var(--primary-color); border-radius: 5px; }
        @media (max-width: 768px) { 
            .sidebar { transform: translateX(-100%); width: 200px; } 
            .sidebar.right { transform: translateX(100%); } 
            .main-content { margin-left: 0; margin-right: 0; } 
            .main-content.top { margin-top: 120px; } 
            .sidebar.active { transform: translateX(0); } 
        }
    </style>
</head>
<body class="dark">
    <canvas id="particles"></canvas>
    <div class="header">
        <img src="https://media.discordapp.net/attachments/1367435618078035998/1375058450874368020/2025-05-10_21.28.12.png?ex=68304e7a&is=682efcfa&hm=7332adb7114ced1cdc64412b353ad2fc4ec0b107bbbcd3540ac9ba9a9874820a&=&format=webp&quality=lossless&width=952&height=656" alt="Death End">
        <h1>Dashboard - Death End</h1>
        <button id="logoutButton">Đăng Xuất</button>
    </div>

    <div class="container">
        <div class="sidebar">
            <h2>Menu</h2>
            <ul>
                <li><a href="#members" class="active">Thành Viên</a></li>
                <li><a href="#events">Sự Kiện</a></li>
                <li><a href="#announcements">Thông Báo</a></li>
                <li><a href="#join-groups">Join Các Nhóm</a></li>
                <li><a href="#minecraft-server">IP Server Minecraft</a></li>
                <li><a href="#chat">Chat </a></li>
                <li><a href="#ranks">Rank </a></li>
                <li><a href="#theme-settings">Tùy Chỉnh Giao Diện</a></li>
            </ul>
        </div>

        <div class="main-content">
            <div id="members" class="content-section active">
                <h2>Thành Viên</h2>
                <div id="membersList" class="members">
                    <div class="member" onclick="showMemberDetails('Hacktivist', 'Member', '01/04/2025', 'Thích chơi PvP và xây dựng trên server Minecraft.', 'https://via.placeholder.com/20')">
                        <img src="https://minotar.net/avatar/Hacktivist/80" alt="Hacktivist">
                        <div class="name-container">
                            <img class="name-icon" src="https://via.placeholder.com/20" alt="Icon">
                            <p>???</p>
                        </div>
                        <div class="rank member">Member</div>
                    </div>
                    <div class="member" onclick="showMemberDetails('Shadow', 'Leader', '15/03/2025', 'Chuyên tổ chức sự kiện trên server.', 'https://via.placeholder.com/20')">
                        <img src="https://minotar.net/avatar/Shadow/80" alt="Shadow">
                        <div class="name-container">
                            <img class="name-icon" src="https://via.placeholder.com/20" alt="Icon">
                            <p>???</p>
                        </div>
                        <div class="rank leader">Leader</div>
                    </div>
                    <div class="member" onclick="showMemberDetails('Cipher', 'Admin', '10/02/2025', 'Quản lý server và xử lý vi phạm.', 'https://via.placeholder.com/20')">
                        <img src="https://minotar.net/avatar/Cipher/80" alt="Cipher">
                        <div class="name-container">
                            <img class="name-icon" src="https://via.placeholder.com/20" alt="Icon">
                            <p>Cipher</p>
                        </div>
                        <div class="rank admin">Admin</div>
                    </div>
                    <div class="member" onclick="showMemberDetails('Neo', 'Leader', '20/03/2025', 'Yêu thích xây dựng và sáng tạo.', 'https://via.placeholder.com/20')">
                        <img src="https://minotar.net/avatar/Neo/80" alt="Neo">
                        <div class="name-container">
                            <img class="name-icon" src="https://via.placeholder.com/20" alt="Icon">
                            <p>Neo</p>
                        </div>
                        <div class="rank leader">Leader</div>
                    </div>
                    <div class="member" onclick="showMemberDetails('Zero', 'Member', '05/04/2025', 'Thường xuyên tham gia PvP.', 'https://via.placeholder.com/20')">
                        <img src="https://minotar.net/avatar/Zero/80" alt="Zero">
                        <div class="name-container">
                            <img class="name-icon" src="https://via.placeholder.com/20" alt="Icon">
                            <p>???</p>
                        </div>
                        <div class="rank member">Member</div>
                    </div>
                </div>
                <div class="add-btn" onclick="toggleAddMemberForm()">+</div>
                <div id="addMemberForm" class="add-form">
                    <input type="text" id="avatarUrl" placeholder="Minecraft Username (for Skin)" required>
                    <input type="text" id="memberName" placeholder="Tên Thành Viên" required>
                    <button onclick="addMember()">Thêm</button>
                </div>
                <div id="adminPanel" class="admin-panel">
                    <h3>Quản Trị (Admin/Owner Only)</h3>
                    <select id="rankMember">
                        <option value="none">Chọn Thành Viên</option>
                    </select>
                    <select id="rankLevel">
                        <option value="Member">Member</option>
                        <option value="Leader">Leader</option>
                        <option value="Admin">Admin</option>
                        <option value="Owner">Owner</option>
                    </select>
                    <button onclick="assignRank()">Phân Rank</button>
                    <input type="text" id="postContent" placeholder="Nội dung bài đăng" required>
                    <select id="postSection">
                        <option value="events">Sự Kiện</option>
                        <option value="announcements">Thông Báo</option>
                        <option value="join-groups">Join Các Nhóm</option>
                        <option value="minecraft-server">IP Server Minecraft</option>
                    </select>
                    <button onclick="postContent()">Đăng Bài</button>
                </div>
                <div id="memberDetails" class="member-details">
                    <img id="detailAvatar" src="" alt="">
                    <p><strong>Tên:</strong> <span id="detailName"></span></p>
                    <p><strong>Rank:</strong> <span id="detailRank"></span></p>
                    <p><strong>Ngày tham gia:</strong> <span id="detailJoinDate"></span></p>
                    <p><strong>Bio:</strong> <span id="detailBio"></span></p>
                    <button class="edit-btn" onclick="toggleEditForm()">Chỉnh Sửa</button>
                    <button class="delete-btn" onclick="deleteMember()">Xóa</button>
                    <div id="editMemberForm" class="edit-form">
                        <input type="text" id="editJoinDate" placeholder="Ngày tham gia (DD/MM/YYYY)">
                        <input type="text" id="editBio" placeholder="Bio">
                        <input type="text" id="editIconUrl" placeholder="URL ảnh bên cạnh tên (20x20)">
                        <button onclick="saveMemberDetails()">Lưu</button>
                    </div>
                    <button class="close-btn" onclick="hideMemberDetails()">Đóng</button>
                </div>
            </div>

            <div id="events" class="content-section">
                <h2>Sự Kiện</h2>
                <ul id="eventsList">
                    <li>???????</li>
                    <li>???!!!????</li>
                    <li>???!!!???</li>
                </ul>
                <div class="add-btn" onclick="toggleAddForm('events')">+</div>
                <div id="addEventsForm" class="add-form">
                    <input type="text" id="eventsInput" placeholder="Thêm sự kiện mới" required>
                    <button onclick="addContent('events')">Thêm</button>
                </div>
            </div>

            <div id="announcements" class="content-section">
                <h2>Thông Báo</h2>
                <ul id="announcementsList">
                    <li>Cập nhật quy tắc cộng đồng: Không chia sẻ công cụ bất hợp pháp.</li>
                    <li>Đọc nọi quy</li>
                    <li>Tham gia Discord để nhận thông tin mới nhất!</li>
                </ul>
                <div class="add-btn" onclick="toggleAddForm('announcements')">+</div>
                <div id="addAnnouncementsForm" class="add-form">
                    <input type="text" id="announcementsInput" placeholder="Thêm thông báo mới" required>
                    <button onclick="addContent('announcements')">Thêm</button>
                </div>
            </div>

            <div id="join-groups" class="content-section">
                <h2>Join Các Nhóm</h2>
                <ul id="joinGroupsList">
                    <li><a href="https://discord.gg/mWYPUUbNPF" target="_blank">Discord Team</a></li>
                    <li><a href="https://t.me/???" target="_blank">???</a></li>
                    <li><a href="https://github.???" target="_blank">???</a></li>
                </ul>
                <div class="add-btn" onclick="toggleAddForm('join-groups')">+</div>
                <div id="addJoinGroupsForm" class="add-form">
                    <input type="text" id="joinGroupsInput" placeholder="Thêm link nhóm (https://...)" required>
                    <button onclick="addContent('join-groups')">Thêm</button>
                </div>
            </div>

            <div id="minecraft-server" class="content-section">
                <h2>IP Server Minecraft</h2>
                <ul id="minecraftList">
                    <li>CHƯA CÓ</li>
                </ul>
                <div class="add-btn" onclick="toggleAddForm('minecraft-server')">+</div>
                <div id="addMinecraftForm" class="add-form">
                    <input type="text" id="minecraftInput" placeholder="Thêm IP server" required>
                    <button onclick="addContent('minecraft-server')">Thêm</button>
                </div>
            </div>

            <div id="chat" class="content-section">
                <h2>Chat Nhóm</h2>
                <div id="chatContainer" class="chat-container"></div>
                <div class="chat-form">
                    <input type="text" id="chatInput" placeholder="Nhập tin nhắn...">
                    <button onclick="sendMessage()">Gửi</button>
                </div>
            </div>

            <div id="ranks" class="content-section">
                <h2>Rank Cấp Bậc</h2>
                <ul id="ranksList">
                    <li>? - Member</li>
                    <li>? - Leader</li>
                    <li>? - Admin</li>
                    <li>? - Leader</li>
                    <li>? - Member</li>
                </ul>
            </div>

            <div id="theme-settings" class="content-section">
                <h2>Tùy Chỉnh Giao Diện</h2>
                <div class="theme-options">
                    <h3>Chủ Đề Màu Sắc</h3>
                    <label><input type="radio" name="theme" value="light" onclick="changeTheme('light')"> Sáng</label>
                    <label><input type="radio" name="theme" value="dark" onclick="changeTheme('dark')" checked> Tối</label>
                    <label><input type="radio" name="theme" value="rgb" onclick="changeTheme('rgb')"> RGB</label>
                </div>
                <div class="theme-options">
                    <h3>Vị Trí Sidebar</h3>
                    <label><input type="radio" name="sidebar" value="top" onclick="changeSidebarPosition('top')"> Trên</label>
                    <label><input type="radio" name="sidebar" value="left" onclick="changeSidebarPosition('left')" checked> Trái</label>
                    <label><input type="radio" name="sidebar" value="right" onclick="changeSidebarPosition('right')"> Phải</label>
                </div>
                <div class="theme-options">
                    <h3>Màu Chủ Đạo</h3>
                    <input type="color" id="primaryColor" value="#1e90ff" onchange="changePrimaryColor(this.value)">
                </div>
            </div>
        </div>
    </div>

    <script>
        const username = localStorage.getItem('loggedInUser');
        if (!username) { window.location.href = 'index.html'; }

        document.getElementById('logoutButton').addEventListener('click', function() { localStorage.removeItem('loggedInUser'); window.location.href = 'index.html'; });

        const menuLinks = document.querySelectorAll('.sidebar a');
        const sections = document.querySelectorAll('.content-section');

        menuLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                menuLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                sections.forEach(section => section.classList.remove('active'));
                document.getElementById(targetId).classList.add('active');
            });
        });

        // Load and manage members
        let members = JSON.parse(localStorage.getItem('members')) || [
            { avatar: "https://minotar.net/avatar/Hacktivist/80", name: "???", rank: "Member", joinDate: "01/04/2025", bio: "Thích chơi PvP và xây dựng trên server Minecraft.", iconUrl: "https://via.placeholder.com/20" },
            { avatar: "https://minotar.net/avatar/Shadow/80", name: "???", rank: "Leader", joinDate: "15/03/2025", bio: "Chuyên tổ chức sự kiện trên server.", iconUrl: "https://via.placeholder.com/20" },
            { avatar: "https://minotar.net/avatar/Cipher/80", name: "???", rank: "Admin", joinDate: "10/02/2025", bio: "Quản lý server và xử lý vi phạm.", iconUrl: "https://via.placeholder.com/20" },
            { avatar: "https://minotar.net/avatar/Neo/80", name: "???", rank: "Leader", joinDate: "20/03/2025", bio: "Yêu thích xây dựng và sáng tạo.", iconUrl: "https://via.placeholder.com/20" },
            { avatar: "https://minotar.net/avatar/Zero/80", name: "???", rank: "Member", joinDate: "05/04/2025", bio: "Thường xuyên tham gia PvP.", iconUrl: "https://via.placeholder.com/20" }
        ];

        let eventsList = JSON.parse(localStorage.getItem('eventsList')) || [
            "???",
            "???",
            "???"
        ];

        let announcementsList = JSON.parse(localStorage.getItem('announcementsList')) || [
            "Cập nhật quy tắc cộng đồng: Không chia sẻ công cụ bất hợp pháp.",
            "",
            "Tham gia Discord để nhận thông tin mới nhất!"
        ];

        let joinGroupsList = JSON.parse(localStorage.getItem('joinGroupsList')) || [
            { text: "Discord team ", link: "https://discord.gg/mWYPUUbNPF" },
            { text: "?", link: "https://t.me/" },
            { text: "?", link: "https://github.com/" }
        ];

        let minecraftList = JSON.parse(localStorage.getItem('minecraftList')) || [
            ""
        ];

        let chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [];

        function renderMembers() {
            const membersList = document.getElementById('membersList');
            membersList.innerHTML = '';
            members.forEach(member => {
                const memberDiv = document.createElement('div');
                memberDiv.classList.add('member');
                memberDiv.setAttribute('onclick', `showMemberDetails('${member.name}', '${member.rank}', '${member.joinDate}', '${member.bio}', '${member.iconUrl}')`);
                memberDiv.innerHTML = `
                    <img src="${member.avatar}" alt="${member.name}">
                    <div class="name-container">
                        <img class="name-icon" src="${member.iconUrl}" alt="Icon">
                        <p>${member.name}</p>
                    </div>
                    <div class="rank ${member.rank.toLowerCase()}">${member.rank}</div>
                `;
                membersList.appendChild(memberDiv);
            });
            updateRankSelect();
        }

        let currentMemberName = '';
        function showMemberDetails(name, rank, joinDate, bio, iconUrl) {
            currentMemberName = name;
            document.getElementById('detailAvatar').src = `https://minotar.net/avatar/${name}/100`;
            document.getElementById('detailName').textContent = name;
            document.getElementById('detailRank').textContent = rank;
            document.getElementById('detailJoinDate').textContent = joinDate;
            document.getElementById('detailBio').textContent = bio;
            const editBtn = document.querySelector('.edit-btn');
            const deleteBtn = document.querySelector('.delete-btn');
            const currentUser = members.find(m => m.name === username);
            const targetMember = members.find(m => m.name === name);
            if (username === name || (username === 'admin' && members.some(m => m.name === 'admin' && (m.rank === 'Admin' || m.rank === 'Owner')))) {
                editBtn.style.display = 'block';
            } else {
                editBtn.style.display = 'none';
            }
            if (currentUser && ['Owner', 'Admin', 'Leader'].includes(currentUser.rank) && targetMember && targetMember.rank === 'Member') {
                deleteBtn.style.display = 'block';
            } else {
                deleteBtn.style.display = 'none';
            }
            document.getElementById('memberDetails').classList.add('active');
        }

        function hideMemberDetails() {
            document.getElementById('memberDetails').classList.remove('active');
            document.getElementById('editMemberForm').style.display = 'none';
        }

        function toggleEditForm() {
            const form = document.getElementById('editMemberForm');
            form.style.display = form.style.display === 'block' ? 'none' : 'block';
            const member = members.find(m => m.name === currentMemberName);
            if (member) {
                document.getElementById('editJoinDate').value = member.joinDate;
                document.getElementById('editBio').value = member.bio;
                document.getElementById('editIconUrl').value = member.iconUrl;
            }
        }

        function saveMemberDetails() {
            const joinDate = document.getElementById('editJoinDate').value;
            const bio = document.getElementById('editBio').value;
            const iconUrl = document.getElementById('editIconUrl').value;
            const member = members.find(m => m.name === currentMemberName);
            if (member) {
                if (joinDate) member.joinDate = joinDate;
                if (bio) member.bio = bio;
                if (iconUrl) member.iconUrl = iconUrl;
                localStorage.setItem('members', JSON.stringify(members));
                document.getElementById('detailJoinDate').textContent = joinDate;
                document.getElementById('detailBio').textContent = bio;
                renderMembers();
                renderRanks();
                toggleEditForm();
            }
        }

        function deleteMember() {
            members = members.filter(m => m.name !== currentMemberName);
            localStorage.setItem('members', JSON.stringify(members));
            renderMembers();
            renderRanks();
            hideMemberDetails();
        }

        function toggleAddMemberForm() {
            const form = document.getElementById('addMemberForm');
            form.style.display = form.style.display === 'block' ? 'none' : 'block';
        }

        function addMember() {
            const avatarUrl = document.getElementById('avatarUrl').value;
            const memberName = document.getElementById('memberName').value;
            if (avatarUrl && memberName) {
                const skinUrl = `https://minotar.net/avatar/${avatarUrl}/80`;
                const joinDate = new Date().toLocaleDateString('en-GB').split('/').join('/');
                members.push({ avatar: skinUrl, name: memberName, rank: "Member", joinDate: joinDate, bio: "Thành viên mới, sẵn sàng khám phá server!", iconUrl: "https://via.placeholder.com/20" });
                localStorage.setItem('members', JSON.stringify(members));
                renderMembers();
                document.getElementById('avatarUrl').value = '';
                document.getElementById('memberName').value = '';
                toggleAddMemberForm();
            }
        }

        // Admin panel
        const adminPanel = document.getElementById('adminPanel');
        if (username === 'admin' && members.some(m => m.name === 'admin' && (m.rank === 'Admin' || m.rank === 'Owner'))) {
            adminPanel.style.display = 'block';
        }

        function updateRankSelect() {
            const select = document.getElementById('rankMember');
            select.innerHTML = '<option value="none">Chọn Thành Viên</option>';
            members.forEach(member => {
                const option = document.createElement('option');
                option.value = member.name;
                option.textContent = member.name;
                select.appendChild(option);
            });
        }

        function assignRank() {
            if (username !== 'admin') return;
            const memberName = document.getElementById('rankMember').value;
            const rankLevel = document.getElementById('rankLevel').value;
            if (memberName !== 'none' && rankLevel) {
                const member = members.find(m => m.name === memberName);
                if (member) {
                    member.rank = rankLevel;
                    localStorage.setItem('members', JSON.stringify(members));
                    renderMembers();
                    renderRanks();
                }
            }
        }

        function postContent() {
            if (username !== 'admin') return;
            const content = document.getElementById('postContent').value;
            const section = document.getElementById('postSection').value;
            if (content) {
                const list = document.getElementById(`${section}List`);
                const li = document.createElement('li');
                if (section === 'join-groups') {
                    const a = document.createElement('a');
                    a.href = content;
                    a.target = '_blank';
                    a.textContent = content;
                    li.appendChild(a);
                    joinGroupsList.push({ text: content, link: content });
                    localStorage.setItem('joinGroupsList', JSON.stringify(joinGroupsList));
                } else {
                    li.textContent = content;
                    if (section === 'events') eventsList.push(content);
                    if (section === 'announcements') announcementsList.push(content);
                    if (section === 'minecraft-server') minecraftList.push(content);
                    localStorage.setItem(`${section}List`, JSON.stringify(eval(`${section}List`)));
                }
                list.appendChild(li);
                document.getElementById('postContent').value = '';
            }
        }

        function toggleAddForm(section) {
            const form = document.getElementById(`add${section.charAt(0).toUpperCase() + section.slice(1)}Form`);
            form.style.display = form.style.display === 'block' ? 'none' : 'block';
        }

        function addContent(section) {
            if (!(username === 'admin' && members.some(m => m.name === 'admin' && (m.rank === 'Admin' || m.rank === 'Owner')))) return;
            const input = document.getElementById(`${section}Input`);
            const content = input.value;
            if (content) {
                const list = document.getElementById(`${section}List`);
                const li = document.createElement('li');
                if (section === 'join-groups') {
                    const a = document.createElement('a');
                    a.href = content;
                    a.target = '_blank';
                    a.textContent = content;
                    li.appendChild(a);
                    joinGroupsList.push({ text: content, link: content });
                    localStorage.setItem('joinGroupsList', JSON.stringify(joinGroupsList));
                } else {
                    li.textContent = content;
                    if (section === 'events') eventsList.push(content);
                    if (section === 'announcements') announcementsList.push(content);
                    if (section === 'minecraft-server') minecraftList.push(content);
                    localStorage.setItem(`${section}List`, JSON.stringify(eval(`${section}List`)));
                }
                list.appendChild(li);
                input.value = '';
                toggleAddForm(section);
            }
        }

        function renderRanks() {
            const ranksList = document.getElementById('ranksList');
            ranksList.innerHTML = '';
            members.forEach(member => {
                const li = document.createElement('li');
                li.textContent = `${member.name} - ${member.rank}`;
                ranksList.appendChild(li);
            });
        }

        // Chat functionality
        function renderChat() {
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.innerHTML = '';
            chatMessages.forEach(msg => {
                const div = document.createElement('div');
                div.classList.add('chat-message');
                div.innerHTML = `<span>${msg.user}:</span> ${msg.text}`;
                chatContainer.appendChild(div);
            });
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();
            if (text) {
                chatMessages.push({ user: username, text: text });
                localStorage.setItem('chatMessages', JSON.stringify(chatMessages));
                renderChat();
                input.value = '';
            }
        }

        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') sendMessage();
        });

        // Theme settings
        function changeTheme(theme) {
            const body = document.body;
            body.classList.remove('light', 'dark', 'rgb');
            body.classList.add(theme);
            localStorage.setItem('theme', theme);
            if (theme === 'rgb') {
                body.style.background = '';
                body.querySelector('canvas').style.display = 'block';
            } else if (theme === 'light') {
                body.querySelector('canvas').style.display = 'none';
            } else {
                body.querySelector('canvas').style.display = 'block';
            }
        }

        function changeSidebarPosition(position) {
            const sidebar = document.querySelector('.sidebar');
            const mainContent = document.querySelector('.main-content');
            sidebar.classList.remove('top', 'left', 'right');
            mainContent.classList.remove('top', 'left', 'right');
            sidebar.classList.add(position);
            mainContent.classList.add(position);
            localStorage.setItem('sidebarPosition', position);
        }

        function changePrimaryColor(color) {
            document.documentElement.style.setProperty('--primary-color', color);
            localStorage.setItem('primaryColor', color);
        }

        // Load saved settings
        const savedTheme = localStorage.getItem('theme') || 'dark';
        const savedSidebarPosition = localStorage.getItem('sidebarPosition') || 'left';
        const savedPrimaryColor = localStorage.getItem('primaryColor') || '#1e90ff';
        changeTheme(savedTheme);
        changeSidebarPosition(savedSidebarPosition);
        changePrimaryColor(savedPrimaryColor);
        document.querySelector(`input[name="theme"][value="${savedTheme}"]`).checked = true;
        document.querySelector(`input[name="sidebar"][value="${savedSidebarPosition}"]`).checked = true;
        document.getElementById('primaryColor').value = savedPrimaryColor;

        renderMembers();
        renderRanks();
        renderChat();

        // Particle effect
        const canvas = document.getElementById('particles');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let particlesArray = [];
        const numberOfParticles = 150;

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 5 + 1;
                this.speedX = Math.random() * 3 - 1.5;
                this.speedY = Math.random() * 3 - 1.5;
                this.color = `hsl(${Math.random() * 360}, 70%, 50%)`;
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.size > 0.2) this.size -= 0.1;
                if (this.x < 0 || this.x > canvas.width) this.speedX *= -1;
                if (this.y < 0 || this.y > canvas.height) this.speedY *= -1;
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        function init() {
            for (let i = 0; i < numberOfParticles; i++) {
                particlesArray.push(new Particle());
            }
        }

        function animate() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) {
                particlesArray[i].update();
                particlesArray[i].draw();
                if (particlesArray[i].size <= 0.2) {
                    particlesArray.splice(i, 1);
                    i--;
                    particlesArray.push(new Particle());
                }
            }
            requestAnimationFrame(animate);
        }

        init();
        animate();

        window.addEventListener('resize', function() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>